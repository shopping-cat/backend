# Migration `20201204074655-init`

This migration has been generated by hyun at 12/4/2020, 4:46:55 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `User` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `updatedAt` DATETIME(3) NOT NULL,
    `email` VARCHAR(191) NOT NULL,
UNIQUE INDEX `User.email_unique`(`email`),

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `UserRefundBankAccount` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `updatedAt` DATETIME(3) NOT NULL,
    `bankName` VARCHAR(191) NOT NULL,
    `accountNumber` INT NOT NULL,
    `ownerName` VARCHAR(191) NOT NULL,
    `userId` INT NOT NULL,
UNIQUE INDEX `UserRefundBankAccount_userId_unique`(`userId`),

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `SearchKeyword` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `keyword` VARCHAR(191) NOT NULL,
    `userId` INT NOT NULL,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Coupon` (
    `id` VARCHAR(191) NOT NULL,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `name` VARCHAR(191) NOT NULL,
    `period` DATETIME(3) NOT NULL,
    `minItemPrice` INT,
    `maxSalePrice` INT,
    `salePercent` INT,
    `salePrice` INT,
    `userId` INT NOT NULL,
    `orderId` INT,
UNIQUE INDEX `Coupon_orderId_unique`(`orderId`),

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `CartItem` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `option` JSON NOT NULL,
    `itemId` INT NOT NULL,
    `userId` INT NOT NULL,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Order` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `updatedAt` DATETIME(3) NOT NULL,
    `address` VARCHAR(191) NOT NULL,
    `phone` VARCHAR(191) NOT NULL,
    `state` VARCHAR(191) NOT NULL,
    `reason` VARCHAR(191),
    `deliveryMessage` VARCHAR(191),
    `itemOption` VARCHAR(191),
    `pointSale` INT NOT NULL,
    `userId` INT NOT NULL,
    `paymentId` INT NOT NULL,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Payment` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `updatedAt` DATETIME(3) NOT NULL,
    `state` VARCHAR(191) NOT NULL,
    `paymentMethod` VARCHAR(191) NOT NULL,
    `cashReceipt` VARCHAR(191) NOT NULL,
    `cashReceiptData` VARCHAR(191),
    `refundMethod` ENUM('cardCancel', 'refundAccout'),
    `price` INT NOT NULL,
    `itemSale` INT NOT NULL,
    `couponSale` INT NOT NULL,
    `pointSale` INT NOT NULL,
    `totalPrice` INT NOT NULL,
    `userId` INT NOT NULL,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `ItemReview` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `updatedAt` DATETIME(3) NOT NULL,
    `content` VARCHAR(191),
    `rate` INT NOT NULL,
    `userId` INT NOT NULL,
    `itemId` INT NOT NULL,
    `orderId` INT NOT NULL,
UNIQUE INDEX `ItemReview_orderId_unique`(`orderId`),

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `ItemReviewImage` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `uri` VARCHAR(191) NOT NULL,
    `itemReviewId` INT NOT NULL,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Item` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `updatedAt` DATETIME(3) NOT NULL,
    `state` ENUM('sale', 'stop', 'noStock') NOT NULL,
    `name` VARCHAR(191) NOT NULL,
    `price` INT NOT NULL,
    `sale` INT NOT NULL,
    `option` JSON NOT NULL,
    `html` VARCHAR(191) NOT NULL,
    `category` ENUM('feed') NOT NULL,
    `partnerId` INT NOT NULL,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `ItemImage` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `uri` VARCHAR(191) NOT NULL,
    `itemId` INT NOT NULL,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Partner` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `updatedAt` DATETIME(3) NOT NULL,
    `email` VARCHAR(191) NOT NULL,
    `shopName` VARCHAR(191) NOT NULL,
    `licenseNumber` VARCHAR(191) NOT NULL,
    `shopImage` VARCHAR(191) NOT NULL,
UNIQUE INDEX `Partner.email_unique`(`email`),
UNIQUE INDEX `Partner.shopName_unique`(`shopName`),

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `_UserItemReviewLike` (
    `A` INT NOT NULL,
    `B` INT NOT NULL,
UNIQUE INDEX `_UserItemReviewLike_AB_unique`(`A`,
`B`),
INDEX `_UserItemReviewLike_B_index`(`B`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `_UserItemReviewUnlike` (
    `A` INT NOT NULL,
    `B` INT NOT NULL,
UNIQUE INDEX `_UserItemReviewUnlike_AB_unique`(`A`,
`B`),
INDEX `_UserItemReviewUnlike_B_index`(`B`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `_ItemToUser` (
    `A` INT NOT NULL,
    `B` INT NOT NULL,
UNIQUE INDEX `_ItemToUser_AB_unique`(`A`,
`B`),
INDEX `_ItemToUser_B_index`(`B`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `_ItemToOrder` (
    `A` INT NOT NULL,
    `B` INT NOT NULL,
UNIQUE INDEX `_ItemToOrder_AB_unique`(`A`,
`B`),
INDEX `_ItemToOrder_B_index`(`B`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `UserRefundBankAccount` ADD FOREIGN KEY (`userId`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `SearchKeyword` ADD FOREIGN KEY (`userId`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `Coupon` ADD FOREIGN KEY (`userId`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `Coupon` ADD FOREIGN KEY (`orderId`) REFERENCES `Order`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `CartItem` ADD FOREIGN KEY (`itemId`) REFERENCES `Item`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `CartItem` ADD FOREIGN KEY (`userId`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `Order` ADD FOREIGN KEY (`userId`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `Order` ADD FOREIGN KEY (`paymentId`) REFERENCES `Payment`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `Payment` ADD FOREIGN KEY (`userId`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `ItemReview` ADD FOREIGN KEY (`userId`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `ItemReview` ADD FOREIGN KEY (`itemId`) REFERENCES `Item`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `ItemReview` ADD FOREIGN KEY (`orderId`) REFERENCES `Order`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `ItemReviewImage` ADD FOREIGN KEY (`itemReviewId`) REFERENCES `ItemReview`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `Item` ADD FOREIGN KEY (`partnerId`) REFERENCES `Partner`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `ItemImage` ADD FOREIGN KEY (`itemId`) REFERENCES `Item`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `_UserItemReviewLike` ADD FOREIGN KEY (`A`) REFERENCES `ItemReview`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `_UserItemReviewLike` ADD FOREIGN KEY (`B`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `_UserItemReviewUnlike` ADD FOREIGN KEY (`A`) REFERENCES `ItemReview`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `_UserItemReviewUnlike` ADD FOREIGN KEY (`B`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `_ItemToUser` ADD FOREIGN KEY (`A`) REFERENCES `Item`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `_ItemToUser` ADD FOREIGN KEY (`B`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `_ItemToOrder` ADD FOREIGN KEY (`A`) REFERENCES `Item`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `_ItemToOrder` ADD FOREIGN KEY (`B`) REFERENCES `Order`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201204074655-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,187 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "mysql"
+  url = "***"
+}
+
+model User {
+  id                Int                    @id @default(autoincrement())
+  createdAt         DateTime               @default(now())
+  updatedAt         DateTime               @updatedAt
+  email             String                 @unique
+  Coupons           Coupon[]
+  Orders            Order[]
+  Payments          Payment[]
+  RefundBankAccount UserRefundBankAccount?
+  ItemReviews       ItemReview[] // 내가 쓴 리뷰
+  ItemReviewLikes   ItemReview[]           @relation("UserItemReviewLike") // 좋아요 누른 리뷰
+  ItemReviewUnlikes ItemReview[]           @relation("UserItemReviewUnlike") // 싫어요 누른 리뷰
+  ItemLikes         Item[]
+  Cart              CartItem[]
+  SearchKeyword     SearchKeyword[]
+}
+
+model UserRefundBankAccount {
+  id            Int      @id @default(autoincrement())
+  createdAt     DateTime @default(now())
+  updatedAt     DateTime @updatedAt
+  bankName      String
+  accountNumber Int
+  ownerName     String
+  User          User     @relation(fields: [userId], references: [id])
+  userId        Int
+}
+
+model SearchKeyword {
+  id        Int      @id @default(autoincrement())
+  createdAt DateTime @default(now())
+  keyword   String
+  user      User     @relation(fields: [userId], references: [id])
+  userId    Int
+}
+
+model Coupon {
+  id           String   @id @default(uuid())
+  createdAt    DateTime @default(now())
+  name         String
+  period       DateTime
+  minItemPrice Int?
+  maxSalePrice Int?
+  salePercent  Int?
+  salePrice    Int?
+  User         User     @relation(fields: [userId], references: [id])
+  Order        Order?   @relation(fields: [orderId], references: [id])
+  userId       Int
+  orderId      Int?
+}
+
+model CartItem {
+  id        Int      @id @default(autoincrement())
+  createdAt DateTime @default(now())
+  option    Json
+  Item      Item     @relation(fields: [itemId], references: [id])
+  User      User     @relation(fields: [userId], references: [id])
+  itemId    Int
+  userId    Int
+}
+
+model Order {
+  id              Int         @id @default(autoincrement())
+  createdAt       DateTime    @default(now())
+  updatedAt       DateTime    @updatedAt
+  address         String
+  phone           String
+  state           String
+  reason          String?
+  deliveryMessage String?
+  itemOption      String?
+  pointSale       Int
+  Coupon          Coupon?
+  ItemReview      ItemReview?
+  Item            Item[]
+  User            User        @relation(fields: [userId], references: [id])
+  Payment         Payment     @relation(fields: [paymentId], references: [id])
+  userId          Int
+  paymentId       Int
+}
+
+model Payment {
+  id              Int           @id @default(autoincrement())
+  createdAt       DateTime      @default(now())
+  updatedAt       DateTime      @updatedAt
+  state           String
+  paymentMethod   String
+  cashReceipt     String
+  cashReceiptData String?
+  refundMethod    RefundMethod?
+  price           Int
+  itemSale        Int
+  couponSale      Int
+  pointSale       Int
+  totalPrice      Int
+  Orders          Order[]
+  User            User          @relation(fields: [userId], references: [id])
+  userId          Int
+}
+
+model ItemReview {
+  id          Int               @id @default(autoincrement())
+  createdAt   DateTime          @default(now())
+  updatedAt   DateTime          @updatedAt
+  content     String?
+  rate        Int
+  UserLikes   User[]            @relation("UserItemReviewLike")
+  UserUnLikes User[]            @relation("UserItemReviewUnlike")
+  Images      ItemReviewImage[]
+  User        User              @relation(fields: [userId], references: [id])
+  Item        Item              @relation(fields: [itemId], references: [id])
+  Order       Order             @relation(fields: [orderId], references: [id])
+  userId      Int
+  itemId      Int
+  orderId     Int
+}
+
+model ItemReviewImage {
+  id           Int        @id @default(autoincrement())
+  createdAt    DateTime   @default(now())
+  uri          String
+  ItemReview   ItemReview @relation(fields: [itemReviewId], references: [id])
+  itemReviewId Int
+}
+
+model Item {
+  id        Int          @id @default(autoincrement())
+  createdAt DateTime     @default(now())
+  updatedAt DateTime     @updatedAt
+  state     ItemState
+  name      String
+  price     Int
+  sale      Int
+  option    Json
+  html      String
+  category  Category
+  Images    ItemImage[]
+  Orders    Order[]
+  Reviews   ItemReview[]
+  Cart      CartItem[]
+  UserLikes User[]
+  Partner   Partner      @relation(fields: [partnerId], references: [id])
+  partnerId Int
+}
+
+model ItemImage {
+  id        Int      @id @default(autoincrement())
+  createdAt DateTime @default(now())
+  uri       String
+  Item      Item     @relation(fields: [itemId], references: [id])
+  itemId    Int
+}
+
+model Partner {
+  id            Int      @id @default(autoincrement())
+  createdAt     DateTime @default(now())
+  updatedAt     DateTime @updatedAt
+  email         String   @unique
+  shopName      String   @unique
+  licenseNumber String
+  shopImage     String
+  Item          Item[]
+}
+
+enum Category {
+  feed
+}
+
+enum RefundMethod {
+  cardCancel
+  refundAccout
+}
+
+enum ItemState {
+  sale
+  stop
+  noStock
+}
```


